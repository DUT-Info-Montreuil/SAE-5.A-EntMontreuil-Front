<!-- single-classroom.component.html -->
<div *ngIf="classroomData">
  <h1>Salle de classe: {{ classroomData.name }}</h1>
  <p>Capacité: {{ classroomData.capacity }}</p>

  <button class="w3-button w3-blue w3-round" (click)="goBack()">
    <i class="pi pi-arrow-left"></i> Retour
  </button>

  <button class="w3-button w3-green w3-round" (click)="openEquipmentDialog()">
    <i class="pi pi-plus"></i> Ajouter un équipement
  </button>

  <div
    *ngIf="
      classroomData.materials && classroomData.materials.length > 0;
      else noEquipments
    "
  >
    <div class="card">
      <p-table
        [value]="classroomData.materials"
        [paginator]="true"
        [rows]="5"
        [showCurrentPageReport]="true"
        [tableStyle]="{ 'min-width': '50rem' }"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
        [rowsPerPageOptions]="[10, 25, 50]"
      >
        <ng-template pTemplate="header">
          <tr>
            <th style="width: 25%">Id</th>
            <th style="width: 25%">Équipement</th>
            <th style="width: 25%">Quantité</th>
            <th style="width: 25%">Actions</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-material let-i="rowIndex">
          <tr>
            <td>{{ material.id }}</td>
            <td>{{ material.equipment }}</td>
            <td>
              <div *ngIf="editingIndex !== i">
                {{ material.quantity }}
                <button
                  class="w3-button w3-blue w3-round"
                  (click)="startEdit(i, material)"
                >
                  <i class="pi pi-pencil"></i>
                </button>
              </div>
              <div *ngIf="editingIndex === i">
                <input type="number" [(ngModel)]="editingQuantity" min="1" />
                <button
                  class="w3-button w3-green w3-round"
                  (click)="updateQuantity(material.id)"
                >
                  <i class="pi pi-check"></i>
                </button>
                <button
                  class="w3-button w3-red w3-round"
                  (click)="cancelEdit()"
                >
                  <i class="pi pi-times"></i>
                </button>
              </div>
            </td>
            <td>
              <button
                class="w3-button w3-red w3-round"
                (click)="confirmDelete(material.id)"
              >
                <i class="pi pi-trash"></i> Supprimer
              </button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <ng-template #noEquipments>
    <p>Aucun équipement ajouté à cette salle de classe.</p>
  </ng-template>
</div>

<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>
